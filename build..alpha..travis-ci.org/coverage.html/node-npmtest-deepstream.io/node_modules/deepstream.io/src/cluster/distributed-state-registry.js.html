<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-deepstream.io/node_modules/deepstream.io/src/cluster/distributed-state-registry.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-deepstream.io">npmtest-deepstream.io (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-deepstream.io/node_modules/deepstream.io/src/cluster/distributed-state-registry.js</span></h1>
    <h2>
        
        Statements: <span class="metric">7.84% <small>(8 / 102)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 47)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 20)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">7.84% <small>(8 / 102)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-deepstream.io/node_modules/deepstream.io/src/cluster/</a> &#187; distributed-state-registry.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">'use strict'
&nbsp;
const C = require('../constants/constants')
const EventEmitter = require('events').EventEmitter
&nbsp;
const DATA_LENGTH = {}
DATA_LENGTH[C.EVENT.DISTRIBUTED_STATE_REQUEST_FULL_STATE] = 1
DATA_LENGTH[C.EVENT.DISTRIBUTED_STATE_FULL_STATE] = 2
DATA_LENGTH[C.EVENT.DISTRIBUTED_STATE_ADD] = 3
DATA_LENGTH[C.EVENT.DISTRIBUTED_STATE_REMOVE] = 3
&nbsp;
/**
 * This class provides a generic mechanism that allows to maintain
 * a distributed state amongst the nodes of a cluster. The state is an
 * array of unique strings in arbitrary order.
 *
 * Whenever a string is added by any node within the cluster for the first time,
 * an 'add' event is emitted. Whenever its removed by the last node within the cluster,
 * a 'remove' event is emitted.
 *
 * @extends {EventEmitter}
 *
 * @event 'add' emitted whenever an entry is added for the first time
 * @event 'remove' emitted whenever an entry is removed by the last node
 *
 * @author DeepstreamHub GmbH 2016
 */
module.exports = class DistributedStateRegistry extends EventEmitter {
&nbsp;
  /**
  * Initialises the DistributedStateRegistry and subscribes to the provided cluster topic
  *
  * @param   {String} topic   A TOPIC constant
  * @param   {Object} options Global deepstream server options
  *
  * @constructor
  */
  constructor <span class="fstat-no" title="function not covered" >(topic, options) {</span>
<span class="cstat-no" title="statement not covered" >    super()</span>
<span class="cstat-no" title="statement not covered" >    this._topic = topic</span>
<span class="cstat-no" title="statement not covered" >    this._options = options</span>
<span class="cstat-no" title="statement not covered" >    this._options.messageConnector.subscribe(topic, this._processIncomingMessage.bind(this))</span>
<span class="cstat-no" title="statement not covered" >    this._options.clusterRegistry.on('remove', this.removeAll.bind(this))</span>
<span class="cstat-no" title="statement not covered" >    this._data = {}</span>
<span class="cstat-no" title="statement not covered" >    this._reconciliationTimeouts = {}</span>
<span class="cstat-no" title="statement not covered" >    this._fullStateSent = false</span>
<span class="cstat-no" title="statement not covered" >    this._requestFullState(C.ALL)</span>
  }
&nbsp;
  /**
  * Checks if a given entry exists within the registry
  *
  * @param   {String}  name       the name of the entry
  *
  * @public
  * @returns {Boolean} exists
  */
  has <span class="fstat-no" title="function not covered" >(name) {</span>
<span class="cstat-no" title="statement not covered" >    return !!this._data[name]</span>
  }
&nbsp;
  /**
  * Add a name/entry to the registry. If the entry doesn't exist yet,
  * this will notify the other nodes within the cluster
  *
  * @param {String} name any string key
  *
  * @public
  * @returns {void}
  */
  add <span class="fstat-no" title="function not covered" >(name) {</span>
<span class="cstat-no" title="statement not covered" >    if (!this._has(name, this._options.serverName)) {</span>
<span class="cstat-no" title="statement not covered" >      this._add(name, this._options.serverName)</span>
<span class="cstat-no" title="statement not covered" >      this._sendMessage(name, C.EVENT.DISTRIBUTED_STATE_ADD)</span>
    }
  }
&nbsp;
  /**
  * Removes a name/entry from the registry. If the entry doesn't exist,
  * this will exit silently
  *
  * @param {String} name any previously added name
  *
  * @public
  * @returns {void}
  */
  remove <span class="fstat-no" title="function not covered" >(name) {</span>
<span class="cstat-no" title="statement not covered" >    if (this._has(name, this._options.serverName)) {</span>
<span class="cstat-no" title="statement not covered" >      this._remove(name, this._options.serverName)</span>
<span class="cstat-no" title="statement not covered" >      this._sendMessage(name, C.EVENT.DISTRIBUTED_STATE_REMOVE)</span>
    }
  }
&nbsp;
  /**
  * Removes all entries for a given serverName. This is intended to be called
  * whenever a node leaves the cluster
  *
  * @param   {String} serverName The serverName of a node within the cluster
  *
  * @returns {[type]}
  */
  removeAll <span class="fstat-no" title="function not covered" >(serverName) {</span>
<span class="cstat-no" title="statement not covered" >    let name</span>
<span class="cstat-no" title="statement not covered" >    for (name in this._data) {</span>
<span class="cstat-no" title="statement not covered" >      if (this._data[name].nodes[serverName]) {</span>
<span class="cstat-no" title="statement not covered" >        this._remove(name, serverName)</span>
      }
    }
  }
&nbsp;
  /**
  * Returns all the servers that hold a given state
  *
  * @public
  * @returns {Object} entries
  */
  getAllServers <span class="fstat-no" title="function not covered" >(name) {</span>
<span class="cstat-no" title="statement not covered" >    if (this._data[name]) {</span>
<span class="cstat-no" title="statement not covered" >      return Object.keys(this._data[name].nodes)</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return []</span>
  }
&nbsp;
  /**
  * Returns all currently registered entries
  *
  * @public
  * @returns {Array} entries
  */
  getAll <span class="fstat-no" title="function not covered" >() {</span>
<span class="cstat-no" title="statement not covered" >    return Object.keys(this._data)</span>
  }
&nbsp;
  /**
  * Removes an entry for a given serverName. If the serverName
  * was the last node that held the entry, the entire entry will
  * be removed and a `remove` event will be emitted
  *
  * @param   {String} name       the name of the entry
  * @param   {String} serverName the name of the server that no longer holds the entry
  *
  * @private
  * @returns {void}
  */
  _remove <span class="fstat-no" title="function not covered" >(name, serverName) {</span>
<span class="cstat-no" title="statement not covered" >    let exists = false</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!this._data[name]) {</span>
<span class="cstat-no" title="statement not covered" >      return</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    delete this._data[name].nodes[serverName]</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (const nodeName in this._data[name].nodes) {</span>
<span class="cstat-no" title="statement not covered" >      if (this._data[name].nodes[nodeName] === true) {</span>
<span class="cstat-no" title="statement not covered" >        exists = true</span>
      }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (exists === false) {</span>
<span class="cstat-no" title="statement not covered" >      delete this._data[name]</span>
<span class="cstat-no" title="statement not covered" >      this.emit('remove', name)</span>
    }
  }
&nbsp;
  /**
  * Adds a new entry to this registry, either as a result of a remote or
  * a local addition. Will emit an `add` event if the entry wasn't present before
  *
  * @param {String} name       the name of the new entry
  * @param {String} serverName the name of the server that added the entry
  *
  * @private
  * @returns {void}
  */
  _add <span class="fstat-no" title="function not covered" >(name, serverName) {</span>
<span class="cstat-no" title="statement not covered" >    if (!this._data[name]) {</span>
<span class="cstat-no" title="statement not covered" >      this._data[name] = {</span>
        nodes: {},
        checkSum: this._createCheckSum(name)
      }
<span class="cstat-no" title="statement not covered" >      this.emit('add', name)</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    this._data[name].nodes[serverName] = true</span>
  }
&nbsp;
  /**
  * Checks if a given entry exists for a given serverName
  *
  * @param   {String}  name       the name of the entry
  * @param   {String}  serverName the name of the server that might hold the entry
  *
  * @private
  * @returns {Boolean} exists
  */
  _has <span class="fstat-no" title="function not covered" >(name, serverName) {</span>
<span class="cstat-no" title="statement not covered" >    return this._data[name] &amp;&amp; this._data[name].nodes[serverName]</span>
  }
&nbsp;
  /**
  * Generic messaging function for add and remove messages
  *
  * @param   {String} name   the name of the entry that's added or removed
  * @param   {String} action action-constant, one of C.EVENT.&lt;&gt;
  *
  * @private
  * @returns {void}
  */
  _sendMessage <span class="fstat-no" title="function not covered" >(name, action) {</span>
<span class="cstat-no" title="statement not covered" >    const message = {</span>
      topic: this._topic,
      action,
      data: [name, this._options.serverName, this._getCheckSumTotal(this._options.serverName)]
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    this._options.messageConnector.publish(this._topic, message)</span>
  }
&nbsp;
  /**
  * This method calculates the total checkSum for all local entries of
  * a given serverName
  *
  * @param {String} serverName the name of the server for which the checkSum should be calculated
  *
  * @private
  * @returns {Number} totalCheckSum
  */
  _getCheckSumTotal <span class="fstat-no" title="function not covered" >(serverName) {</span>
<span class="cstat-no" title="statement not covered" >    let totalCheckSum = 0</span>
<span class="cstat-no" title="statement not covered" >    let name</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (name in this._data) {</span>
<span class="cstat-no" title="statement not covered" >      if (this._data[name].nodes[serverName]) {</span>
<span class="cstat-no" title="statement not covered" >        totalCheckSum += this._data[name].checkSum</span>
      }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return totalCheckSum</span>
  }
&nbsp;
  /**
  * Calculates a simple checkSum for a given name. This is done up-front and cached
  * to increase performance for local add and remove operations. Arguably this is a generic
  * method and might be moved to the utils class if we find another usecase for it.
  *
  * @param   {String} name the name of the entry
  *
  * @private
  * @returns {Number} checkSum
  */
  _createCheckSum <span class="fstat-no" title="function not covered" >(name) {</span> // eslint-disable-line
<span class="cstat-no" title="statement not covered" >    let checkSum = 0</span>
<span class="cstat-no" title="statement not covered" >    let i</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (i = 0; i &lt; name.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >      checkSum = ((checkSum &lt;&lt; 5) - checkSum) + name.charCodeAt(i) </span>// eslint-disable-line
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return checkSum</span>
  }
&nbsp;
  /**
  * Checks a remote checkSum for a given serverName against the
  * actual checksum for all local entries for the given name.
  *
  * - If the checksums match, it removes all possibly pending
  *   reconciliationTimeouts
  *
  * - If the checksums don't match, it schedules a reconciliation request. If
  *   another message from the remote server arrives before the reconciliation request
  *   is send, it will be cancelled.
  *
  * @param   {String} serverName     the name of the remote server for which the checkSum
  *                                  should be calculated
  * @param   {Number} remoteCheckSum The checksum the remote server has calculated for all
  *                                  its local entries
  *
  * @private
  * @returns {void}
  */
  _verifyCheckSum <span class="fstat-no" title="function not covered" >(serverName, remoteCheckSum) {</span>
<span class="cstat-no" title="statement not covered" >    if (this._getCheckSumTotal(serverName) !== remoteCheckSum) {</span>
<span class="cstat-no" title="statement not covered" >      this._reconciliationTimeouts[serverName] = setTimeout(</span>
                this._requestFullState.bind(this, serverName),
                this._options.stateReconciliationTimeout
            )
    } else <span class="cstat-no" title="statement not covered" >if (this._reconciliationTimeouts[serverName]) {</span>
<span class="cstat-no" title="statement not covered" >      clearTimeout(this._reconciliationTimeouts[serverName])</span>
<span class="cstat-no" title="statement not covered" >      delete this._reconciliationTimeouts[serverName]</span>
    }
  }
&nbsp;
  /**
  * Sends a reconciliation request for a server with a given name (technically, its send to
  * every node within the cluster, but will be ignored by all but the one with a matching name)
  *
  * The matching node will respond with a DISTRIBUTED_STATE_FULL_STATE message
  *
  * @param   {String} serverName The name of the node with the compromised state
  *
  * @private
  * @returns {void}
  */
  _requestFullState <span class="fstat-no" title="function not covered" >(serverName) {</span>
<span class="cstat-no" title="statement not covered" >    this._options.messageConnector.publish(this._topic, {</span>
      topic: this._topic,
      action: C.EVENT.DISTRIBUTED_STATE_REQUEST_FULL_STATE,
      data: [serverName]
    })
  }
&nbsp;
  /**
  * Creates a full state message containing an array of all local entries that
  * will be used to reconcile compromised states as well as provide the full state
  * for new nodes that joined the cluster
  *
  * When a state gets compromised, more than one remote registry might request a full state update.
  * This method will  schedule a timeout in which no additional full state messages are sent to
  * make sure only a single full state message is sent in reply.
  *
  * @private
  * @returns {void}
  */
  _sendFullState <span class="fstat-no" title="function not covered" >() {</span>
<span class="cstat-no" title="statement not covered" >    const localState = []</span>
<span class="cstat-no" title="statement not covered" >    let name</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (name in this._data) {</span>
<span class="cstat-no" title="statement not covered" >      if (this._data[name].nodes[this._options.serverName]) {</span>
<span class="cstat-no" title="statement not covered" >        localState.push(name)</span>
      }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    this._options.messageConnector.publish(this._topic, {</span>
      topic: this._topic,
      action: C.EVENT.DISTRIBUTED_STATE_FULL_STATE,
      data: [this._options.serverName, localState]
    })
&nbsp;
<span class="cstat-no" title="statement not covered" >    this._fullStateSent = true</span>
<span class="cstat-no" title="statement not covered" >    setTimeout(this._resetFullStateSent.bind(this), this._options.stateReconciliationTimeout)</span>
  }
&nbsp;
  /**
  * This will apply the data from an incoming full state message. Entries that are not within
  * the incoming array will be removed for that node from the local registry and new entries will
  * be added.
  *
  * @param   {String} serverName the name of the server that send the full state message
  * @param   {Array}  names      a full list of all local entries of that server in arbitrary order
  *
  * @private
  * @returns {void}
  */
  _applyFullState <span class="fstat-no" title="function not covered" >(serverName, names) {</span>
<span class="cstat-no" title="statement not covered" >    let name</span>
<span class="cstat-no" title="statement not covered" >    let i</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (name in this._data) {</span>
            // please note: only checking if the name exists is sufficient as the registry will just
            // set node[serverName] to false if the entry exists, but not for the remote server.
<span class="cstat-no" title="statement not covered" >      if (names.indexOf(name) === -1) {</span>
<span class="cstat-no" title="statement not covered" >        this._remove(name, serverName)</span>
      }
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (i = 0; i &lt; names.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >      this._add(names[i], serverName)</span>
    }
  }
&nbsp;
  /**
  * Will be called after a full state message has been sent and
  * stateReconciliationTimeout has passed. This will allow further reconciliation
  * messages to be sent again.
  *
  * @private
  * @returns {void}
  */
  _resetFullStateSent <span class="fstat-no" title="function not covered" >() {</span>
<span class="cstat-no" title="statement not covered" >    this._fullStateSent = false</span>
  }
&nbsp;
  /**
  * This is the main routing point for messages coming in from
  * the message connector.
  *
  * @param   {Object} message a message connector message with topic, action and data fields
  *
  * @private
  * @returns {void}
  */
  _processIncomingMessage <span class="fstat-no" title="function not covered" >(message) {</span>
<span class="cstat-no" title="statement not covered" >    if (!this._isValidMessage(message)) {</span>
<span class="cstat-no" title="statement not covered" >      return</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (message.action === C.EVENT.DISTRIBUTED_STATE_ADD) {</span>
<span class="cstat-no" title="statement not covered" >      this._add(message.data[0], message.data[1])</span>
<span class="cstat-no" title="statement not covered" >      this._verifyCheckSum(message.data[1], message.data[2])</span>
    } else <span class="cstat-no" title="statement not covered" >if (message.action === C.EVENT.DISTRIBUTED_STATE_REMOVE) {</span>
<span class="cstat-no" title="statement not covered" >      this._remove(message.data[0], message.data[1])</span>
<span class="cstat-no" title="statement not covered" >      this._verifyCheckSum(message.data[1], message.data[2])</span>
    } else <span class="cstat-no" title="statement not covered" >if (message.action === C.EVENT.DISTRIBUTED_STATE_REQUEST_FULL_STATE) {</span>
<span class="cstat-no" title="statement not covered" >      if (</span>
        message.data[0] === C.ALL ||
        (message.data[0] === this._options.serverName &amp;&amp; this._fullStateSent === false)
      ) {
<span class="cstat-no" title="statement not covered" >        this._sendFullState()</span>
      }
    } else <span class="cstat-no" title="statement not covered" >if (message.action === C.EVENT.DISTRIBUTED_STATE_FULL_STATE) {</span>
<span class="cstat-no" title="statement not covered" >      this._applyFullState(message.data[0], message.data[1])</span>
    }
  }
&nbsp;
  /**
  * Performs basic validations for incoming messages, based on action and data-length
  *
  * @param   {Object} message a message connector message with topic, action and data fields
  *
  * @private
  * @returns {Boolean} isValid
  */
  _isValidMessage <span class="fstat-no" title="function not covered" >(message) {</span>
<span class="cstat-no" title="statement not covered" >    if (DATA_LENGTH[message.action] === undefined) {</span>
<span class="cstat-no" title="statement not covered" >      this._options.logger.log(C.LOG_LEVEL.WARN, C.EVENT.UNKNOWN_ACTION, message.action)</span>
<span class="cstat-no" title="statement not covered" >      return false</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (message.data.length !== DATA_LENGTH[message.action]) {</span>
<span class="cstat-no" title="statement not covered" >      this._options.logger.log(C.LOG_LEVEL.WARN, C.EVENT.INVALID_MESSAGE_DATA, message.data)</span>
<span class="cstat-no" title="statement not covered" >      return false</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return true</span>
  }
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Thu Apr 20 2017 16:09:03 GMT+0000 (UTC)</div>
</div>
</body>
</html>
